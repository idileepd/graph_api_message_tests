var content = `<html style="padding:0; margin:0; font-family:&quot;Segoe UI&quot;,&quot;Segoe WP&quot;,&quot;Segoe&quot;,Tahoma,Frutiger,&quot;Frutiger Linotype&quot;,&quot;Dejavu Sans&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif"><head>\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta content="IE=edge"><meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"></head><body style="padding:0; margin:0; font-family:&quot;Segoe UI&quot;,&quot;Segoe WP&quot;,&quot;Segoe&quot;,Tahoma,Frutiger,&quot;Frutiger Linotype&quot;,&quot;Dejavu Sans&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif"><style>\n\x3C!--\n:root, html, body\n\t{padding:0;\n\tmargin:0;\n\tfont-family:"Segoe UI","Segoe WP","Segoe",Tahoma,Frutiger,"Frutiger Linotype","Dejavu Sans","Helvetica Neue",Arial,sans-serif}\ntable\n\t{border-collapse:collapse}\ntd\n\t{padding:0;\n\tborder-collapse:collapse}\n.hello\n\t{text-align:left}\n.hello h1\n\t{font-size:24px;\n\tline-height:24px;\n\tcolor:#0B7ED9;\n\tmargin:0;\n\tpadding:0;\n\tfont-family:"Segoe UI","Segoe WP","Segoe",Tahoma,Frutiger,"Frutiger Linotype","Dejavu Sans","Helvetica Neue",Arial,sans-serif;\n\tfont-weight:300}\n.weather-location\n\t{text-align:right;\n\tline-height:9px}\n.weather\n\t{font-size:10px!important;\n\tline-height:9px;\n\ttext-align:right}\n.weather p\n\t{font-size:10px!important;\n\tline-height:12px!important;\n\tcolor:#7f7f7f;\n\tmargin:0;\n\ttext-align:right}\n.weather p span\n\t{font-weight:bold;\n\tfont-size:10px!important}\n.location img\n\t{margin:0 0 0 10px}\n.title h2\n\t{font-size:14px;\n\tline-height:14px;\n\tcolor:#333333;\n\tmargin:30px 0 20px 0;\n\tpadding:0;\n\tfont-family:"Segoe UI","Segoe WP","Segoe",Tahoma,Frutiger,"Frutiger Linotype","Dejavu Sans","Helvetica Neue",Arial,sans-serif;\n\tfont-weight:600}\n.event-list\n\t{width:100%}\n.event-list td\n\t{padding:0 0 5px 0}\n.event-date p\n\t{color:#333;\n\tfont-size:13px;\n\tline-height:17px;\n\tmargin:3px 0 0 0;\n\tfont-family:"Segoe UI","Segoe WP","Segoe",Tahoma,Frutiger,"Frutiger Linotype","Dejavu Sans","Helvetica Neue",Arial,sans-serif}\n.event-date p span\n\t{color:#666}\n.event-content p\n\t{margin:3px 0 20px 0;\n\tcolor:#333;\n\tfont-size:13px;\n\tline-height:19px}\n.smallstop .event-content p\n\t{margin:1px 0 20px 0}\n.event-content p span\n\t{color:#666}\n.event-list tbody tr:last-child .event-content\n\t{padding:0 0 30px 0}\n.event-list tbody:last-child tr:last-child .event-busstop\n\t{background:none}\n.event-list tbody tr:last-child\n\t{padding:0 0 20px 0}\n.keys\n\t{text-align:center}\n.keys td p\n\t{margin:0;\n\tpadding:0}\n.keys td span\n\t{font-size:13px;\n\tline-height:20px;\n\tfont-weight:600;\n\tvertical-align:top;\n\tmargin:0 10px}\n.tasks\n\t{border-top:1px solid #eaeaea}\n.tasks h3\n\t{font-size:14px;\n\tline-height:14px;\n\tcolor:#0B7ED9;\n\tmargin:25px 0 15px 0;\n\tpadding:0;\n\tfont-family:"Segoe UI","Segoe WP",Tahoma,Frutiger,"Frutiger Linotype","Dejavu Sans","Helvetica Neue",Arial,sans-serif;\n\tfont-weight:600}\n.tasks ul\n\t{list-style:none;\n\tpadding:0;\n\tmargin:0}\n.tasks ul\n\t{margin:0 0 10px 0}\n.tasks ul li\n\t{font-size:13px;\n\tline-height:19px}\n.tasks ul li.complete\n\t{text-decoration:line-through;\n\tcolor:#666}\n.tasks span\n\t{color:#999;\n\tfont-size:13px;\n\tline-height:13px;\n\tdisplay:inline-block}\n.tasks span a, .tasks span a:visited\n\t{color:#999;\n\ttext-decoration:none}\n.tasks span a:hover\n\t{color:#000}\n.footer\n\t{border-top:1px solid #eaeaea;\n\ttext-align:center;\n\tcolor:#7b7b7b;\n\tmargin:0 0 15px 0}\n.footer p\n\t{font-size:12px;\n\tline-height:15px;\n\tmargin:25px 0 0 0}\n.footer a, .footer a:visited\n\t{color:#7b7b7b}\n.footer a:hover\n\t{color:#adadad}\n.footer p span\n\t{color:#adadad}\n@media screen and (max-width: 800px) {\n\n\t}\n.circle\n\t{border-radius:50%;\n\tz-index:2;\n\tmargin:auto}\n.circle_small\n\t{width:8px;\n\theight:8px}\n-->\n</style><table width="100%" bgcolor="#ffffff" align="left" style="border-collapse:collapse"><tbody><tr><td style="padding:8px 0 0 0px; border-collapse:collapse"><table cellpadding="0" cellspacing="0" border="0" bgcolor="#ffffff" style="border-collapse:collapse"><tbody><tr><td colspan="3" height="40" style="padding:0; border-collapse:collapse">&nbsp;</td></tr><tr><td style="padding:10px; border-collapse:collapse">&nbsp;</td><td width="440" style="padding:0; border-collapse:collapse"><table cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse"><tbody><tr><td class="hello" style="padding:0; border-collapse:collapse; text-align:left"><h1 style="font-size:21px; line-height:28px; color:#212121; margin:10px 0 0 0; padding:0; font-family:&quot;Segoe UI&quot;,&quot;Segoe WP&quot;,&quot;Segoe&quot;,Tahoma,Frutiger,&quot;Frutiger Linotype&quot;,&quot;Dejavu Sans&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif; font-weight:300">Hello Dileep Nagendra,</h1></td></tr></tbody></table><table cellpadding="0" cellspacing="0" border="0" width="100%" class="title" style="border-collapse:collapse"><tbody><tr><td width="100%" style="padding:0; border-collapse:collapse"><h2 style="font-size:17px; line-height:20px; color:#333333; margin:30px 0 20px 0; padding:0; font-family:&quot;Segoe UI&quot;,&quot;Segoe WP&quot;,&quot;Segoe&quot;,Tahoma,Frutiger,&quot;Frutiger Linotype&quot;,&quot;Dejavu Sans&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif; font-weight:300">Your agenda for <span style="font-family:&quot;Segoe UI&quot;,&quot;Segoe WP&quot;,&quot;Segoe&quot;,Tahoma,Frutiger,&quot;Frutiger Linotype&quot;,&quot;Dejavu Sans&quot;,&quot;Helvetica Neue&quot;,Arial,sans-serif; font-weight:300">Monday, February 1, 2021 </span></h2></td></tr></tbody></table><table cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse; width:100%"><tbody><tr><td width="80" valign="top" style="padding:0 0 5px 0; border-collapse:collapse"><p style="color:#333; font-size:13px; line-height:17px; margin:3px 0 0 0">Tasks</p></td><td><table cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse; width:100%"><tbody><tr><td width="24" align="center" valign="top" style="padding:0 0 0 0; border-collapse:collapse"><img src="cid:task" width="24px" height="24px" style="border-radius:12px"> </td><td width="23" style="padding:0 0 5px 0; border-collapse:collapse">&nbsp;</td><td width="350"><p style="margin:1px 0 20px 0; color:#333; font-size:13px; line-height:19px"><a href="https://outlook.com/?viewmodel=TaskReadingPaneViewModelPopOutFactory&amp;ItemID=AQMkADAwATM3ZmYAZS0zMwA4NS04MjRjLTAwAi0wMAoARgAAA4LTyPL1jNpGqZqb61AQqykHAH4X%2byTldjpBsp7CU3P5lhwAAAImGwAAAH4X%2byTldjpBsp7CU3P5lhwAAAAxDuSUAAAA&amp;Source=AgendaMail" itemscope="" itemid="AQMkADAwATM3ZmYAZS0zMwA4NS04MjRjLTAwAi0wMAoARgAAA4LTyPL1jNpGqZqb61AQqykHAH4X_yTldjpBsp7CU3P5lhwAAAImGwAAAH4X_yTldjpBsp7CU3P5lhwAAAAxDuSUAAAA" itemtype="microsoft.graph.task" style="text-decoration:none; color:#0078D7">Documents for gate</a> </p></td></tr></tbody></table></td></tr><tr><td colspan="2" height="15px" style="padding:0; border-collapse:collapse">&nbsp; </td></tr></tbody></table><table cellpadding="0" cellspacing="0" border="0" width="100%" height="100%" class="event-list" style="border-collapse:collapse; width:100%"><tbody></tbody></table><table cellpadding="0" cellspacing="0" border="0" width="100%" class="keys" style="border-collapse:collapse; text-align:center"><tbody><tr><td height="30px" style="padding:0; border-collapse:collapse">&nbsp; </td></tr></tbody></table><table cellpadding="0" cellspacing="0" border="0" width="100%" class="footer" style="border-collapse:collapse; border-top:1px solid #eaeaea; text-align:center; color:#7b7b7b; margin:0 0 15px 0"><tbody><tr><td height="15px" style="padding:0; border-collapse:collapse">&nbsp; </td></tr><tr><td width="100%" style="padding:0; border-collapse:collapse"><a href="https://outlook.live.com/"><img src="cid:outlookLogo" width="120" height="29" style="margin:15px 0 0 10px"> </a></td></tr><tr><td width="100%" style="padding:0; border-collapse:collapse"><p style="font-size:12px; line-height:15px; margin:15px 0 0 0"><a href="https://outlook.com/calendar/options/calendar/agendaMail" style="color:#7b7b7b">Agenda mail settings</a> <br><a href="https://outlook.live.com/owa/calendar/00037ffe-3385-824c-0000-000000000000@outlook.com/agendamail/unsubscribe/41cf25af-be59-44ee-8c54-a3869c1dd0b6" style="color:#7b7b7b">Unsubscribe</a> â€¢ <a href="https://go.microsoft.com/fwlink/?LinkId=521839" style="color:#7b7b7b">Privacy statement</a> <br><span style="color:#adadad">Microsoft Corporation, One Microsoft Way, Redmond, WA 98052</span> </p></td></tr></tbody></table></td><td style="padding:10px; border-collapse:collapse">&nbsp;</td></tr><tr><td colspan="3" height="20" style="padding:0; border-collapse:collapse">&nbsp;</td></tr></tbody></table></td></tr></tbody></table></body></html>`

let insertConentToHtmlBody = (htmlContent, content) => {
  const errorMessage = "unable to parse HTML"
  const bodyStart = htmlContent.indexOf("<body")
  if (bodyStart === -1) return errorMessage
  const bodyEndsAt = htmlContent.substring(bodyStart).indexOf(">") + htmlContent.lastIndexOf('<body') + 1
  if (bodyEndsAt === -1) return errorMessage
  return htmlContent.slice(0, bodyEndsAt) + content + htmlContent.slice(bodyEndsAt);
}

console.log(insertConentToHtmlBody(content, "<p>cool s bro</p> <h1>chill bro</h1>"))